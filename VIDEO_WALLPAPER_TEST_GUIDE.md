# 动态壁纸测试指南

## 概述
本指南介绍如何使用 `7081_raw.mp4` 视频文件测试 jitata 应用的动态壁纸功能。

## 测试功能特性

### 1. 视频测试工具 (`VideoTestHelper`)
- **自动视频加载**: 从项目Bundle或Documents目录加载测试视频
- **视频验证**: 检查视频是否适合作为动态壁纸
- **Live Photo导出测试**: 验证视频转Live Photo功能

### 2. 视频测试界面 (`VideoTestView`)
- **iPhone屏幕模拟**: 200x400pt的模拟iPhone屏幕预览
- **视频分析报告**: 显示时长、分辨率、宽高比等信息
- **适配性检查**: 自动检测视频是否适合作为动态壁纸
- **问题诊断**: 列出发现的问题和优化建议

## 测试步骤

### 步骤1: 启动测试
1. 打开 jitata 应用
2. 在首页点击右上角的 "测试" 按钮（橙色图标）
3. 应用会自动加载并分析 `7081_raw.mp4` 视频

### 步骤2: 查看分析结果
测试界面会显示以下信息：
- **📱 壁纸预览**: 模拟iPhone屏幕的视频预览效果
- **📊 视频分析报告**: 
  - 时长（秒）
  - 分辨率（像素）
  - 宽高比
  - 壁纸适配状态（✅适合 / ❌需要优化）

### 步骤3: 问题诊断
如果视频不完全适合作为动态壁纸，会显示：
- **⚠️ 发现的问题**: 具体问题列表
- **💡 优化建议**: 改进建议

### 步骤4: Live Photo导出测试
1. 点击 "测试Live Photo导出" 按钮
2. 应用会将视频转换为Live Photo并保存到相册
3. 成功后可以到相册查看并设置为动态壁纸

## 动态壁纸适配标准

### 理想参数
- **时长**: 3-5秒（最长不超过10秒）
- **宽高比**: 9:16（竖屏比例）
- **分辨率**: 至少720p（建议1080p或更高）
- **格式**: MP4格式，H.264编码

### 常见问题及解决方案

#### 1. 宽高比不匹配
- **问题**: 当前视频不是9:16比例
- **解决**: 重新生成视频时选择9:16宽高比

#### 2. 视频时长过长
- **问题**: 视频超过10秒
- **解决**: 剪辑视频到3-5秒

#### 3. 分辨率过低
- **问题**: 分辨率低于720p
- **解决**: 使用更高分辨率重新生成

## 测试文件信息

### 7081_raw.mp4
- **位置**: 项目根目录
- **用途**: 动态壁纸效果测试
- **加载方式**: 
  1. 优先从应用Bundle加载
  2. 备选从Documents目录加载
  3. 最后从项目根目录复制到Documents

## 技术实现

### 核心组件
1. **VideoTestHelper**: 视频测试工具类
2. **VideoTestView**: 测试界面视图
3. **VideoValidationResult**: 验证结果数据结构
4. **LivePhotoExporter**: Live Photo导出功能

### 验证逻辑
```swift
// 检查时长
if durationSeconds > 10 {
    issues.append("视频时长过长")
}

// 检查宽高比
let targetAspectRatio: CGFloat = 9.0 / 16.0
if abs(aspectRatio - targetAspectRatio) > 0.1 {
    issues.append("宽高比不匹配")
}

// 检查分辨率
if maxDimension < 720 {
    issues.append("分辨率较低")
}
```

## 使用场景

### 开发测试
- 验证视频播放功能
- 测试Live Photo导出
- 检查动态壁纸适配性

### 用户体验测试
- 模拟真实使用场景
- 验证视频循环播放效果
- 测试导出到相册功能

### 质量保证
- 自动化视频质量检查
- 标准化适配性验证
- 问题诊断和建议

## 注意事项

1. **权限要求**: Live Photo导出需要相册写入权限
2. **性能考虑**: 大视频文件可能影响加载速度
3. **存储空间**: 测试视频会占用应用存储空间
4. **兼容性**: 确保视频格式与iOS兼容

## 后续优化

### 计划改进
1. 支持多个测试视频文件
2. 添加视频编辑功能（裁剪、调整比例）
3. 批量测试功能
4. 自动优化建议实施

### 扩展功能
1. 视频质量评分系统
2. 自动修复常见问题
3. 预设模板应用
4. 社区分享功能

---

通过这个测试工具，您可以全面验证 `7081_raw.mp4` 视频作为动态壁纸的效果，并获得专业的优化建议。 