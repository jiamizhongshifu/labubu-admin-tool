import Foundation

/// æç¤ºè¯ç®¡ç†å™¨
class PromptManager {
    static let shared = PromptManager()
    
    private init() {
        // ç§æœ‰åˆå§‹åŒ–å™¨ï¼Œç¡®ä¿å•ä¾‹æ¨¡å¼
    }
    
    // MARK: - æç¤ºè¯æ¨¡æ¿
    
    /// åŸºç¡€å¢å¼ºæç¤ºè¯
    private let baseEnhancementPrompt = """
    Enhance this object while preserving all original details, features, and characteristics. Keep the exact shape, proportions, and design elements. Improve color saturation, contrast, and material texture. Add appropriate lighting effects. Maintain transparent background. Output as high-quality PNG with 1:1 aspect ratio.
    """
    
    /// é»˜è®¤æç¤ºè¯æ¨¡æ¿ï¼ˆç”¨æˆ·å¯ä»¥å‚è€ƒï¼‰
    private let defaultPromptTemplates: [String] = [
        "Enhance this object while preserving all original details and features. Improve color vibrancy and material texture. Add subtle lighting effects. Maintain transparent background.",
        "Transform this into a high-quality artistic version while keeping all original characteristics. Enhance colors and add professional lighting.",
        "Create a premium enhanced version of this item. Improve material quality and add appropriate visual effects while preserving the original design.",
        """
        è¯·åˆ†æè¿™å¼ å›¾ç‰‡ä¸­çš„ä¸»ä½“ç‰©å“ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºä¸€ä¸ªç²¾ç¾çš„è‰ºæœ¯åŒ–ç‰ˆæœ¬ã€‚è¦æ±‚ï¼š
        
        1. ä¿æŒç‰©å“çš„åŸºæœ¬å½¢çŠ¶å’Œç‰¹å¾
        2. å¢å¼ºè‰²å½©é¥±å’Œåº¦å’Œå¯¹æ¯”åº¦
        3. æ·»åŠ ç²¾ç¾çš„å…‰å½±æ•ˆæœ
        4. æå‡æ•´ä½“çš„è‰ºæœ¯æ„Ÿå’Œæ”¶è—ä»·å€¼
        5. é£æ ¼è¦é€‚åˆä½œä¸ºæ”¶è—å“å±•ç¤º
        
        è¯·ç”Ÿæˆä¸€ä¸ªé«˜è´¨é‡çš„è‰ºæœ¯åŒ–ç‰ˆæœ¬ï¼Œé€‚åˆä½œä¸ºæ•°å­—æ”¶è—å“ã€‚
        """,
        
        // MARK: - æ½®ç©å±•ç¤ºåœºæ™¯æ¨¡æ¿
        
        """
        ğŸª æ½®ç©åº—é“ºå±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©æ”¾ç½®åœ¨ç²¾ç¾çš„æ½®ç©ä¸“å–åº—å±•ç¤ºæŸœä¸­ï¼Œè¥é€ ä¸“ä¸šçš„é›¶å”®å±•ç¤ºæ°›å›´ã€‚è¦æ±‚ï¼š
        - é€æ˜ç»ç’ƒå±•ç¤ºæŸœï¼Œå¸¦æœ‰æŸ”å’Œçš„LEDç¯å…‰
        - ç°ä»£ç®€çº¦çš„åº—é“ºèƒŒæ™¯ï¼Œç•¥å¾®è™šåŒ–
        - ä¸“ä¸šçš„äº§å“å±•ç¤ºç¯å…‰ï¼Œçªå‡ºæ½®ç©ç»†èŠ‚
        - ä¿æŒæ½®ç©åŸæœ‰ç‰¹å¾å’Œè‰²å½©
        - æ·»åŠ é«˜ç«¯é›¶å”®åº—çš„è´¨æ„Ÿ
        - èƒŒæ™¯ä¿æŒé€æ˜æˆ–çº¯è‰²
        """,
        
        """
        ğŸ¨ è‰ºæœ¯ç”»å»Šå±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©ä½œä¸ºè‰ºæœ¯å“åœ¨ç°ä»£ç”»å»Šä¸­å±•ç¤ºã€‚è¦æ±‚ï¼š
        - ç®€æ´çš„ç™½è‰²å±•ç¤ºå°åº§
        - ä¸“ä¸šçš„ç¾æœ¯é¦†çº§åˆ«æ‰“å…‰
        - è¥é€ é«˜é›…çš„è‰ºæœ¯æ°›å›´
        - çªå‡ºæ½®ç©çš„è‰ºæœ¯ä»·å€¼å’Œè®¾è®¡ç¾æ„Ÿ
        - å¢å¼ºæè´¨è´¨æ„Ÿå’Œè‰²å½©å±‚æ¬¡
        - ä¿æŒèƒŒæ™¯ç®€æ´ï¼Œçªå‡ºä¸»ä½“
        - é€‚åˆä½œä¸ºè‰ºæœ¯æ”¶è—å“å±•ç¤º
        """,
        
        """
        ğŸ  å®¶å±…æ”¶è—å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©èå…¥æ¸©é¦¨çš„å®¶å±…æ”¶è—å±•ç¤ºç¯å¢ƒã€‚è¦æ±‚ï¼š
        - æœ¨è´¨æˆ–ç°ä»£æè´¨çš„æ”¶è—å±•ç¤ºæ¶
        - æ¸©æš–èˆ’é€‚çš„å®¶å±…ç¯å…‰æ°›å›´
        - è¥é€ ä¸ªäººæ”¶è—ç©ºé—´çš„æ„Ÿè§‰
        - ä¿æŒæ½®ç©çš„å¯çˆ±å’Œäº²å’ŒåŠ›
        - æ·»åŠ ç”Ÿæ´»åŒ–çš„æ¸©é¦¨è´¨æ„Ÿ
        - èƒŒæ™¯å¯ä»¥æœ‰è½»å¾®çš„å®¶å±…å…ƒç´ è™šåŒ–
        - é€‚åˆæ—¥å¸¸æ¬£èµå’Œå±•ç¤º
        """,
        
        """
        ğŸŒŸ æœªæ¥ç§‘æŠ€å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©ç½®äºå……æ»¡ç§‘æŠ€æ„Ÿçš„æœªæ¥å±•ç¤ºç¯å¢ƒä¸­ã€‚è¦æ±‚ï¼š
        - å…¨æ¯æŠ•å½±å¼çš„å±•ç¤ºæ•ˆæœ
        - è“è‰²æˆ–ç´«è‰²çš„ç§‘æŠ€å…‰æ•ˆ
        - å‡ ä½•å½¢çŠ¶çš„æœªæ¥æ„Ÿå±•ç¤ºå°
        - å¢å¼ºæ½®ç©çš„ç§‘æŠ€è´¨æ„Ÿ
        - æ·»åŠ å¾®å¦™çš„å‘å…‰è¾¹ç¼˜æ•ˆæœ
        - è¥é€ æœªæ¥åšç‰©é¦†çš„æ°›å›´
        - ä¿æŒèƒŒæ™¯çš„ç§‘æŠ€æ„Ÿä½†ä¸æŠ¢å¤ºä¸»ä½“
        """,
        
        """
        ğŸª ä¸»é¢˜ä¹å›­å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©æ”¾ç½®åœ¨æ¢¦å¹»çš„ä¸»é¢˜ä¹å›­å•†åº—å±•ç¤ºåŒºã€‚è¦æ±‚ï¼š
        - å½©è™¹è‰²å½©çš„æ¢¦å¹»èƒŒæ™¯æ°›å›´
        - æ¸¸ä¹å›­å¼çš„æ¬¢å¿«å±•ç¤ºç¯å¢ƒ
        - å¢å¼ºæ½®ç©çš„è¶£å‘³æ€§å’Œå¯çˆ±æ„Ÿ
        - æ·»åŠ è½»å¾®çš„é­”æ³•å…‰æ•ˆ
        - è¥é€ ç«¥è¯èˆ¬çš„å±•ç¤ºæ°›å›´
        - ä¿æŒè‰²å½©é²œè‰³ä½†å’Œè°
        - é€‚åˆå„¿ç«¥å’Œæˆäººå…±åŒæ¬£èµ
        """,
        
        """
        ğŸ† é™å®šæ”¶è—å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©ä½œä¸ºçè´µçš„é™å®šç‰ˆæ”¶è—å“å±•ç¤ºã€‚è¦æ±‚ï¼š
        - è±ªåçš„æ”¶è—å±•ç¤ºç›’æˆ–åº•åº§
        - é‡‘è‰²æˆ–é“¶è‰²çš„é«˜ç«¯è£…é¥°å…ƒç´ 
        - ä¸“ä¸šçš„æ”¶è—å“çº§åˆ«æ‰“å…‰
        - çªå‡ºå…¶ç¨€æœ‰æ€§å’Œæ”¶è—ä»·å€¼
        - å¢å¼ºæè´¨çš„é«˜çº§è´¨æ„Ÿ
        - æ·»åŠ å¾®å¦™çš„å…‰æ³½å’Œåå°„æ•ˆæœ
        - è¥é€ å¥¢åçš„æ”¶è—å“æ°›å›´
        """,
        
        """
        ğŸŒ¸ æ—¥å¼å’Œé£å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©èå…¥ä¼˜é›…çš„æ—¥å¼å’Œé£å±•ç¤ºç¯å¢ƒã€‚è¦æ±‚ï¼š
        - ç®€çº¦çš„æ—¥å¼æœ¨è´¨å±•ç¤ºå°
        - æŸ”å’Œçš„è‡ªç„¶å…‰çº¿æ°›å›´
        - è¥é€ ç¦…æ„å’Œå®é™çš„æ„Ÿè§‰
        - ä¿æŒæ½®ç©çš„ç²¾è‡´å’Œç»†è…»
        - æ·»åŠ æ¸©æ¶¦çš„æè´¨è´¨æ„Ÿ
        - èƒŒæ™¯å¯æœ‰è½»å¾®çš„å’Œé£å…ƒç´ 
        - ä½“ç°æ—¥å¼ç¾å­¦çš„ç®€çº¦ä¸ç²¾è‡´
        """,
        
        """
        ğŸ® ç”µç«æ¸¸æˆå±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©ç½®äºç‚«é…·çš„ç”µç«æ¸¸æˆä¸»é¢˜å±•ç¤ºç¯å¢ƒã€‚è¦æ±‚ï¼š
        - RGBç¯å…‰æ•ˆæœçš„æ¸¸æˆæ°›å›´
        - ç°ä»£ç”µç«é£æ ¼çš„å±•ç¤ºå°
        - å¢å¼ºæ½®ç©çš„åŠ¨æ„Ÿå’Œæ´»åŠ›
        - æ·»åŠ è½»å¾®çš„ç”µå­å…‰æ•ˆ
        - è¥é€ å¹´è½»æ—¶å°šçš„æ¸¸æˆæ–‡åŒ–æ°›å›´
        - ä¿æŒè‰²å½©é²œæ˜ä½†ä¸è¿‡åº¦
        - é€‚åˆæ¸¸æˆçˆ±å¥½è€…æ”¶è—å±•ç¤º
        """,
        
        """
        ğŸŒ™ å¤œæ™¯æ°›å›´å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©ç½®äºæµªæ¼«çš„å¤œæ™¯æ°›å›´ä¸­å±•ç¤ºã€‚è¦æ±‚ï¼š
        - æŸ”å’Œçš„æœˆå…‰æˆ–æ˜Ÿå…‰æ•ˆæœ
        - æ·±è“è‰²æˆ–ç´«è‰²çš„å¤œç©ºèƒŒæ™¯
        - è¥é€ å®é™ç¥ç§˜çš„å¤œæ™šæ°›å›´
        - å¢å¼ºæ½®ç©çš„è½®å»“å’Œç»†èŠ‚
        - æ·»åŠ å¾®å¦™çš„å¤œå…‰æ•ˆæœ
        - ä¿æŒæ¢¦å¹»è€Œä¸å¤±çœŸå®æ„Ÿ
        - é€‚åˆè¥é€ æµªæ¼«æ”¶è—æ°›å›´
        """,
        
        """
        ğŸŒˆ å½©è™¹æ¢¦å¹»å±•ç¤ºåœºæ™¯ï¼š
        å°†è¿™ä¸ªæ½®ç©æ”¾ç½®åœ¨å……æ»¡å½©è™¹è‰²å½©çš„æ¢¦å¹»ä¸–ç•Œä¸­ã€‚è¦æ±‚ï¼š
        - æŸ”å’Œçš„å½©è™¹å…‰è°±èƒŒæ™¯
        - äº‘æœµèˆ¬çš„æ¢¦å¹»å±•ç¤ºå°
        - å¢å¼ºæ½®ç©çš„ç«¥è¶£å’Œæƒ³è±¡åŠ›
        - æ·»åŠ é—ªçƒçš„æ˜Ÿæ˜Ÿç‚¹ç‚¹æ•ˆæœ
        - è¥é€ å¦‚æ¢¦å¦‚å¹»çš„ç«¥è¯æ°›å›´
        - ä¿æŒè‰²å½©ä¸°å¯Œä½†ä¸æ‚ä¹±
        - é€‚åˆæ¿€å‘åˆ›æ„å’Œæƒ³è±¡
        """
    ]
    
    // MARK: - å…¬å…±æ–¹æ³•
    
    /// è·å–é»˜è®¤æç¤ºè¯æ¨¡æ¿
    /// - Returns: é»˜è®¤æç¤ºè¯
    func getDefaultPrompt() -> String {
        return baseEnhancementPrompt
    }
    
    /// è·å–æç¤ºè¯æ¨¡æ¿åˆ—è¡¨
    /// - Returns: æç¤ºè¯æ¨¡æ¿æ•°ç»„
    func getPromptTemplates() -> [String] {
        return defaultPromptTemplates
    }
    
    /// æ·»åŠ è‡ªå®šä¹‰æç¤ºè¯
    /// - Parameters:
    ///   - category: åˆ†ç±»åç§°
    ///   - prompt: æç¤ºè¯å†…å®¹
    func addCustomPrompt(for category: String, prompt: String) {
        // æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æŒä¹…åŒ–å­˜å‚¨
        // categoryPrompts[category] = prompt
        print("è‡ªå®šä¹‰æç¤ºè¯å·²æ·»åŠ ï¼š\(category)")
    }
    
    /// éªŒè¯æç¤ºè¯æ˜¯å¦æœ‰æ•ˆ
    /// - Parameter prompt: æç¤ºè¯
    /// - Returns: æ˜¯å¦æœ‰æ•ˆ
    func validatePrompt(_ prompt: String) -> Bool {
        return !prompt.trimmingCharacters(in: .whitespacesAndNewlines).isEmpty
    }
}

// MARK: - æç¤ºè¯æ¨¡æ¿ç»“æ„

/// æç¤ºè¯æ¨¡æ¿
struct PromptTemplate {
    let id: UUID
    let name: String
    let category: String
    let content: String
    let createdAt: Date
    let isCustom: Bool
    
    init(name: String, category: String, content: String, isCustom: Bool = false) {
        self.id = UUID()
        self.name = name
        self.category = category
        self.content = content
        self.createdAt = Date()
        self.isCustom = isCustom
    }
} 